import{r as i,j as r}from"./index-36003393.js";import{e as p,f as S,g as _,C as g}from"./utils-84ccb15d.js";import{T as y}from"./Table-89f65705.js";import{M as F}from"./Modal-501fdc1f.js";import{M}from"./ModalButton-00fcf1f3.js";import{F as w}from"./Form-3d54bc60.js";import{E as d}from"./config-16fea0ec.js";import{b as B}from"./bootstrap.bundle.min-e26b4c14.js";import"./Grow-7fbf58ee.js";function v(){const[l,a]=i.useState([]),[u,b]=i.useState([]),[m,c]=i.useState({});i.useEffect(()=>{p().then(e=>{a(e)}),S().then(e=>{b(e)})},[]);function j(e){var n;const t=(n=u.find(s=>s.id===e))==null?void 0:n.name;return t||"Неизвестный предмет"}function x(e){a(l.filter(t=>t.id?!e.includes(t.id):!0)),_(e)}function E(e){m.id&&(e.id=m.id),g(e).then(()=>{p().then(t=>{a(t)})})}function P(e){c(e),new B.Modal(document.getElementById("plan_modal"),{}).show()}function o(e,t){var n;return t!="subject_id"?e[t]:(n=u.find(s=>s.id===e.subject_id))==null?void 0:n.name}function h(e,t){const n=l.sort((s,f)=>o(s,e)>o(f,e)?t?1:-1:o(s,e)<o(f,e)?t?-1:1:0);a([...n])}return r.jsxs(r.Fragment,{children:[r.jsx(F,{connected_with:"plan_modal",title:"План",children:r.jsx(w,{elements:[{label:"Название",name:"name",type:d.INPUT,settings:{required:!0}},{label:"Предмет",name:"subject_id",type:d.COMBOBOX,settings:{options:u.map(e=>({id:e.id,label:e.name}))}},{label:"Файл",name:"file",type:d.FILE,settings:{required:!0}}],instance:m,onSubmit:E})}),r.jsx(M,{connected_with:"plan_modal",button_text:"Добавить план",additionalClasses:"m-3",preOpen:()=>c({})}),r.jsx(y,{elements:l,table_fields:[{label:"Название",name:"name"},{label:"Предмет",name:"subject_id",valueProcessing:j}],NeedDelete:!0,NeedEdit:!0,onDelete:x,onEdit:P,Sort:h})]})}export{v as default};
